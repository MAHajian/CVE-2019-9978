<?php

echo "<h1>CVE-2019-9978</h1>";
$options = file_get_contents($_GET['swp_url'].'?swp_debug=get_user_options');
$pre = strpos($options, '<pre>');
if ($pre !== 0) {
	echo('No Social Warfare found.');
}
$options = str_replace('<pre>', '', $options);
$cutoff = strpos($options, '</pre>');
$options = substr($options, 0, $cutoff);
$array = 'return ' . $options . ';';
try {
	$fetched_options = eval( $array );
}
catch (ParseError $e) {
	$message = 'Error evaluating fetched data. <br/>';
	$message .= 'Message from error: ' . $e->getMessage() . '<br/>';
	$message .= 'Fetched data: <br/>';
	$message .= var_export($fetched_options, 1);
	exit($message);
}						
?>
